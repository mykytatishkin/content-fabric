# üì∫ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–Ω—Å–æ–ª—è–º–∏

–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ç–æ–≥–æ, –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –ø—É–±–ª–∏–∫—É–µ—Ç –≤–∏–¥–µ–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö Google Cloud Console –ø—Ä–æ–µ–∫—Ç–æ–≤.

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ (Task)

–ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ –Ω–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏—é:

```python
# –ó–∞–¥–∞—á–∞ –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –∫–∞–Ω–∞–ª—É —á–µ—Ä–µ–∑ account_id
task = {
    'account_id': 1,  # ID –∫–∞–Ω–∞–ª–∞ –≤ –ë–î
    'title': 'Video Title',
    'att_file_path': '/path/to/video.mp4',
    ...
}
```

### 2. Task Worker –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á—É

Task Worker –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–¥–∞—á—É –∏–∑ –ë–î –∏:

1. **–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–Ω–∞–ª –ø–æ ID:**
   ```python
   channel = db.get_channel_by_id(task.account_id)
   ```

2. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω—Å–æ–ª–∏:**
   - –ï—Å–ª–∏ —É –∫–∞–Ω–∞–ª–∞ –µ—Å—Ç—å `console_id` ‚Üí –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Å–æ–ª—å
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `client_id` –∏ `client_secret` –∏–∑ –∫–æ–Ω—Å–æ–ª–∏
   - –ï—Å–ª–∏ –∫–æ–Ω—Å–æ–ª–∏ –Ω–µ—Ç ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç credentials –∏–∑ —Å–∞–º–æ–≥–æ –∫–∞–Ω–∞–ª–∞

3. **–°–æ–∑–¥–∞–µ—Ç account_info:**
   ```python
   account_info = {
       'name': channel.name,
       'channel_id': channel.channel_id,
       'access_token': channel.access_token,  # –¢–æ–∫–µ–Ω –∫–∞–Ω–∞–ª–∞
       'refresh_token': channel.refresh_token,  # –¢–æ–∫–µ–Ω –∫–∞–Ω–∞–ª–∞
       'client_id': console.client_id,  # ‚Üê –ò–∑ –∫–æ–Ω—Å–æ–ª–∏!
       'client_secret': console.client_secret  # ‚Üê –ò–∑ –∫–æ–Ω—Å–æ–ª–∏!
   }
   ```

4. **–ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤–∏–¥–µ–æ:**
   ```python
   youtube_client.post_video(
       account_info=account_info,
       video_path=task.att_file_path,
       ...
   )
   ```

### 3. YouTubeClient –∏—Å–ø–æ–ª—å–∑—É–µ—Ç credentials

–í `YouTubeClient._create_service_with_token()`:

```python
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç client_id –∏ client_secret –∏–∑ account_info (–∏–∑ –∫–æ–Ω—Å–æ–ª–∏)
creds = Credentials(
    token=access_token,  # –¢–æ–∫–µ–Ω –∫–∞–Ω–∞–ª–∞
    refresh_token=refresh_token,  # –¢–æ–∫–µ–Ω –∫–∞–Ω–∞–ª–∞
    client_id=account_info['client_id'],  # ‚Üê –ò–∑ –∫–æ–Ω—Å–æ–ª–∏
    client_secret=account_info['client_secret']  # ‚Üê –ò–∑ –∫–æ–Ω—Å–æ–ª–∏
)
```

---

## üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–≤–æ—Ç—ã

### –ü—Ä–∏–º–µ—Ä —Å 3 –∫–æ–Ω—Å–æ–ª—è–º–∏ –∏ 10 –∫–∞–Ω–∞–ª–∞–º–∏:

```
Console 1 (10,000 –µ–¥–∏–Ω–∏—Ü/–¥–µ–Ω—å)
‚îú‚îÄ‚îÄ Channel 1
‚îú‚îÄ‚îÄ Channel 2
‚îú‚îÄ‚îÄ Channel 3
‚îî‚îÄ‚îÄ Channel 4

Console 2 (10,000 –µ–¥–∏–Ω–∏—Ü/–¥–µ–Ω—å)
‚îú‚îÄ‚îÄ Channel 5
‚îú‚îÄ‚îÄ Channel 6
‚îî‚îÄ‚îÄ Channel 7

Console 3 (10,000 –µ–¥–∏–Ω–∏—Ü/–¥–µ–Ω—å)
‚îú‚îÄ‚îÄ Channel 8
‚îú‚îÄ‚îÄ Channel 9
‚îî‚îÄ‚îÄ Channel 10
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –û–±—â–∞—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –∫–≤–æ—Ç–∞: **30,000 –µ–¥–∏–Ω–∏—Ü/–¥–µ–Ω—å** (–≤–º–µ—Å—Ç–æ 10,000)
- –ö–∞–∂–¥–∞—è –∫–æ–Ω—Å–æ–ª—å –∏–º–µ–µ—Ç —Å–≤–æ—é –Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –∫–≤–æ—Ç—É
- –ö–∞–Ω–∞–ª—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–≤–æ—Ç—É —Å–≤–æ–µ–π –∫–æ–Ω—Å–æ–ª–∏

---

## üîë –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### 1. –¢–æ–∫–µ–Ω—ã –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ Client ID

- **Access Token** –∏ **Refresh Token** –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É `client_id`
- –ï—Å–ª–∏ –≤—ã –º–µ–Ω—è–µ—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –∫–∞–Ω–∞–ª–∞, –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –¢–æ–∫–µ–Ω—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Å –æ–¥–Ω–∏–º `client_id`, –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –¥—Ä—É–≥–∏–º

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Å–æ–ª–∏

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∞—è –∫–æ–Ω—Å–æ–ª—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –∫–∞–Ω–∞–ª—É
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç credentials –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### 3. Fallback –º–µ—Ö–∞–Ω–∏–∑–º

–ï—Å–ª–∏ –∫–æ–Ω—Å–æ–ª—å –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞:
1. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `client_id` –∏ `client_secret` –∏–∑ —Å–∞–º–æ–≥–æ –∫–∞–Ω–∞–ª–∞
2. –ï—Å–ª–∏ –∏—Ö –Ω–µ—Ç –≤ –∫–∞–Ω–∞–ª–µ ‚Üí –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑ `.env` (`YOUTUBE_MAIN_CLIENT_ID`)

---

## üìù –ü—Ä–∏–º–µ—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –í—Å–µ –∫–∞–Ω–∞–ª—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É –∫–æ–Ω—Å–æ–ª—å

```
Console 1 (10,000 –µ–¥–∏–Ω–∏—Ü/–¥–µ–Ω—å)
‚îú‚îÄ‚îÄ Channel 1
‚îú‚îÄ‚îÄ Channel 2
‚îî‚îÄ‚îÄ Channel 3
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–≤–æ—Ç—É Console 1 (10,000 –µ–¥–∏–Ω–∏—Ü/–¥–µ–Ω—å)

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ö–∞–Ω–∞–ª—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –º–µ–∂–¥—É –∫–æ–Ω—Å–æ–ª—è–º–∏

```
Console 1 (10,000 –µ–¥–∏–Ω–∏—Ü/–¥–µ–Ω—å)
‚îú‚îÄ‚îÄ Channel 1
‚îî‚îÄ‚îÄ Channel 2

Console 2 (10,000 –µ–¥–∏–Ω–∏—Ü/–¥–µ–Ω—å)
‚îú‚îÄ‚îÄ Channel 3
‚îî‚îÄ‚îÄ Channel 4
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- Channel 1 –∏ 2 –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–≤–æ—Ç—É Console 1
- Channel 3 –∏ 4 –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–≤–æ—Ç—É Console 2
- –û–±—â–∞—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –∫–≤–æ—Ç–∞: 20,000 –µ–¥–∏–Ω–∏—Ü/–¥–µ–Ω—å

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°–º–µ—à–∞–Ω–Ω—ã–π (—Å –∫–æ–Ω—Å–æ–ª—è–º–∏ –∏ –±–µ–∑)

```
Console 1 (10,000 –µ–¥–∏–Ω–∏—Ü/–¥–µ–Ω—å)
‚îú‚îÄ‚îÄ Channel 1
‚îî‚îÄ‚îÄ Channel 2

Channel 3 (–±–µ–∑ –∫–æ–Ω—Å–æ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ–∏ credentials)
Channel 4 (–±–µ–∑ –∫–æ–Ω—Å–æ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ–∏ credentials)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- Channel 1 –∏ 2 –∏—Å–ø–æ–ª—å–∑—É—é—Ç Console 1 (10,000 –µ–¥–∏–Ω–∏—Ü)
- Channel 3 –∏ 4 –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–≤–æ–∏ credentials (–µ—â–µ 10,000 –µ–¥–∏–Ω–∏—Ü, –µ—Å–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç)
- –ò—Ç–æ–≥–æ: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫–∏–µ credentials —É Channel 3 –∏ 4

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞–Ω–∞–ª–æ–≤ –∏ –∏—Ö –∫–æ–Ω—Å–æ–ª–µ–π:

```bash
python3 scripts/account_manager.py db list
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Å–æ–ª–µ–π:

```bash
python3 scripts/account_manager.py console list
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ SQL:

```sql
SELECT 
    c.name as channel_name,
    c.console_id,
    g.name as console_name,
    g.project_id
FROM youtube_channels c
LEFT JOIN google_consoles g ON c.console_id = g.id
WHERE c.enabled = 1;
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–¢–æ–∫–µ–Ω—ã –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è –º–µ–∂–¥—É –∫–æ–Ω—Å–æ–ª—è–º–∏**
   - –ï—Å–ª–∏ –º–µ–Ω—è–µ—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –∫–∞–Ω–∞–ª–∞, –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
   - –¢–æ–∫–µ–Ω—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Å –æ–¥–Ω–∏–º `client_id`, –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –¥—Ä—É–≥–∏–º

2. **–ö–≤–æ—Ç–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**
   - –ö–∞–∂–¥–∞—è –∫–æ–Ω—Å–æ–ª—å –∏–º–µ–µ—Ç —Å–≤–æ—é –Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –∫–≤–æ—Ç—É
   - –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–≤–æ—Ç—ã**
   - –°–ª–µ–¥–∏—Ç–µ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–≤–æ—Ç—ã –≤ –∫–∞–∂–¥–æ–π –∫–æ–Ω—Å–æ–ª–∏ —á–µ—Ä–µ–∑ Google Cloud Console
   - –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ –∫–∞–Ω–∞–ª—ã —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

## üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é:

1. **–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
   ```
   10 –∫–∞–Ω–∞–ª–æ–≤, 2 –∫–æ–Ω—Å–æ–ª–∏ = 5 –∫–∞–Ω–∞–ª–æ–≤ –Ω–∞ –∫–æ–Ω—Å–æ–ª—å
   ```

2. **–ü–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É:**
   ```
   Console 1 (–æ—Å–Ω–æ–≤–Ω–∞—è) ‚Üí –≤–∞–∂–Ω—ã–µ –∫–∞–Ω–∞–ª—ã
   Console 2 (—Ä–µ–∑–µ—Ä–≤–Ω–∞—è) ‚Üí —Ç–µ—Å—Ç–æ–≤—ã–µ/–≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã
   ```

3. **–ü–æ –Ω–∞–≥—Ä—É–∑–∫–µ:**
   ```
   Console 1 ‚Üí –∫–∞–Ω–∞–ª—ã —Å –≤—ã—Å–æ–∫–æ–π —á–∞—Å—Ç–æ—Ç–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–π
   Console 2 ‚Üí –∫–∞–Ω–∞–ª—ã —Å –Ω–∏–∑–∫–æ–π —á–∞—Å—Ç–æ—Ç–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–π
   ```

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-XX

