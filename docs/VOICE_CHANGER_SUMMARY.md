# Voice Changer - –ü—ñ–¥—Å—É–º–æ–∫ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó üéôÔ∏è

## –©–æ –±—É–ª–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

### 1. –û—Å–Ω–æ–≤–Ω–∏–π –º–æ–¥—É–ª—å ‚úÖ
**–§–∞–π–ª:** `core/utils/voice_changer.py`

–ö–ª–∞—Å `VoiceChanger` –∑ –º–æ–∂–ª–∏–≤–æ—Å—Ç—è–º–∏:
- –ó–º—ñ–Ω–∞ –≥–æ–ª–æ—Å—É –≤ –∞—É–¥—ñ–æ —Ç–∞ –≤—ñ–¥–µ–æ —Ñ–∞–π–ª–∞—Ö
- 4 –≥–æ—Ç–æ–≤–∏—Ö –ø—Ä–µ—Å–µ—Ç–∞ (male_to_female, female_to_male, male_to_child, female_to_child)
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤–ª–∞—Å–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ pitch —ñ formant
- –ü–∞–∫–µ—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —Ñ–∞–π–ª—ñ–≤
- –í–∏—Å–æ–∫–æ—è–∫—ñ—Å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Praat (parselmouth)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—è —Ç–∞ –æ–±'—î–¥–Ω–∞–Ω–Ω—è –∞—É–¥—ñ–æ –∑ –≤—ñ–¥–µ–æ

### 2. CLI —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç ‚úÖ
**–§–∞–π–ª:** `run_voice_changer.py`

–ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:
- –û–±—Ä–æ–±–∫–∞ –æ–∫—Ä–µ–º–∏—Ö —Ñ–∞–π–ª—ñ–≤
- –ü–∞–∫–µ—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π
- –í–∏–±—ñ—Ä –ø—Ä–µ—Å–µ—Ç—ñ–≤
- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–ª–∞—Å–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
- –ü–µ—Ä–µ–≥–ª—è–¥ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –ø—Ä–µ—Å–µ—Ç—ñ–≤
- –î–µ—Ç–∞–ª—å–Ω–∏–π –≤–∏–≤—ñ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

### 3. –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —Å–∏—Å—Ç–µ–º–æ—é –∑–∞–¥–∞—á ‚úÖ
**–§–∞–π–ª:** `app/task_worker.py` (–æ–Ω–æ–≤–ª–µ–Ω–æ)

–î–æ–¥–∞–Ω–æ:
- –ù–æ–≤–∏–π —Ç–∏–ø –∑–∞–¥–∞—á—ñ: `voice_change`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —á–µ—Ä–µ–∑ task worker
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ retry –º–µ—Ö–∞–Ω—ñ–∑–º—É
- –õ–æ–≥—É–≤–∞–Ω–Ω—è —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è ‚úÖ

**–§–∞–π–ª–∏:**
- `docs/guides/VOICE_CHANGER_GUIDE.md` - –ø–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- `VOICE_CHANGER_QUICK_START.md` - —à–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç
- `TESTING_VOICE_CHANGER.md` - —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –∑ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

**–í–∫–ª—é—á–∞—î:**
- –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
- API —Ä–µ—Ñ–µ—Ä–µ–Ω—Å
- Best practices
- Troubleshooting
- Performance benchmarks

### 5. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è ‚úÖ
**–§–∞–π–ª:** `test_voice_changer.py`

–ü–µ—Ä–µ–≤—ñ—Ä—è—î:
- –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
- –ù–∞—è–≤–Ω—ñ—Å—Ç—å FFmpeg
- –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é –º–æ–¥—É–ª—è
- –î–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å –ø—Ä–µ—Å–µ—Ç—ñ–≤
- –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –∑ task system
- –û–±—Ä–æ–±–∫—É —Ä–µ–∞–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤

### 6. –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ ‚úÖ
**–§–∞–π–ª:** `requirements.txt` (–æ–Ω–æ–≤–ª–µ–Ω–æ)

–î–æ–¥–∞–Ω–æ:
- `pydub>=0.25.1`
- `praat-parselmouth>=0.4.3`
- `soundfile>=0.12.1`
- `numpy>=1.24.0`
- `librosa>=0.10.0`

## –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏

### –í–∞—Ä—ñ–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ CLI

```bash
# –ë–∞–∑–æ–≤–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è
python run_voice_changer.py input.mp4 output.mp4 --type male_to_female

# –ü–∞–∫–µ—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞
python run_voice_changer.py --batch videos/ output/ --type male_to_female

# –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ø—Ä–µ—Å–µ—Ç–∏
python run_voice_changer.py --list-presets
```

### –í–∞—Ä—ñ–∞–Ω—Ç 2: –ü—Ä–æ–≥—Ä–∞–º–Ω–æ

```python
from core.utils.voice_changer import change_voice

result = change_voice(
    input_file='video.mp4',
    output_file='output.mp4',
    conversion_type='male_to_female'
)
```

### –í–∞—Ä—ñ–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –∑–∞–¥–∞—á

```python
from core.database.mysql_db import YouTubeMySQLDatabase
from datetime import datetime
import json

db = YouTubeMySQLDatabase()

task_id = db.add_task(
    account_id=0,
    media_type='voice_change',
    title='–ó–º—ñ–Ω–∞ –≥–æ–ª–æ—Å—É',
    att_file_path='/path/to/video.mp4',
    scheduled_time=datetime.now(),
    add_info=json.dumps({
        'conversion_type': 'male_to_female'
    })
)

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≤–æ—Ä–∫–µ—Ä
# python run_task_worker.py
```

## Acceptance Criteria - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ ‚úÖ

### ‚úÖ –ú–µ—Ö–∞–Ω—ñ–∑–º –ø—Ä–∏–π–º–∞—î –≤—ñ–¥–µ–æ/–∞—É–¥—ñ–æ —Ñ–∞–π–ª
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤—ñ–¥–µ–æ: MP4, AVI, MOV, MKV, WebM, FLV
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∞—É–¥—ñ–æ: WAV, MP3, M4A, OGG, FLAC
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—É —Ñ–∞–π–ª—É

### ‚úÖ –ó–º—ñ–Ω—é—î –≥–æ–ª–æ—Å –Ω–µ –≤—Ç—Ä–∞—á–∞—é—á–∏ —è–∫—ñ—Å—Ç—å
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Praat –¥–ª—è –≤–∏—Å–æ–∫–æ—è–∫—ñ—Å–Ω–æ—ó —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó
- –û–ø—Ü—ñ—è `preserve_quality=True` –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó —è–∫–æ—Å—Ç—ñ
- Pitch shifting —á–µ—Ä–µ–∑ semitones (—Ç–æ—á–Ω–∞ –∑–º—ñ–Ω–∞ –≤–∏—Å–æ—Ç–∏)
- Formant shifting –¥–ª—è –∑–º—ñ–Ω–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –≥–æ–ª–æ—Å—É
- –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è clipping

### ‚úÖ –í–∏–¥–∞—î –≥–æ—Ç–æ–≤–∏–π –∑–∞–ø–∏—Å —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å
- –ü–æ–≤–µ—Ä—Ç–∞—î —à–ª—è—Ö –¥–æ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É
- –ú–µ—Ç–∞–¥–∞–Ω—ñ –æ–±—Ä–æ–±–∫–∏ (duration, pitch_shift, formant_shift)
- –°—Ç–∞—Ç—É—Å –æ–±—Ä–æ–±–∫–∏ (success/failed)
- –î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –û–∫—Ä–µ–º–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É —Å–µ—Ä–≤—ñ—Å—ñ
- –ù–µ–∑–∞–ª–µ–∂–Ω–∏–π –º–æ–¥—É–ª—å `voice_changer.py`
- –í–ª–∞—Å–Ω–∏–π CLI —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `run_voice_changer.py`
- –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —ñ—Å–Ω—É—é—á–æ—é —Å–∏—Å—Ç–µ–º–æ—é –∑–∞–¥–∞—á
- –ú–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ standalone –∞–±–æ —á–µ—Ä–µ–∑ task worker

## –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –ø—Ä–µ—Å–µ—Ç–∏

1. **male_to_female** - —á–æ–ª–æ–≤—ñ—á–∏–π ‚Üí –∂—ñ–Ω–æ—á–∏–π –≥–æ–ª–æ—Å
2. **female_to_male** - –∂—ñ–Ω–æ—á–∏–π ‚Üí —á–æ–ª–æ–≤—ñ—á–∏–π –≥–æ–ª–æ—Å
3. **male_to_child** - —á–æ–ª–æ–≤—ñ—á–∏–π ‚Üí –¥–∏—Ç—è—á–∏–π –≥–æ–ª–æ—Å
4. **female_to_child** - –∂—ñ–Ω–æ—á–∏–π ‚Üí –¥–∏—Ç—è—á–∏–π –≥–æ–ª–æ—Å

## –ü–µ—Ä–µ–¥ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è–º

### 1. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

```bash
pip install -r requirements.txt
```

### 2. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å FFmpeg

```bash
# macOS
brew install ffmpeg

# Ubuntu/Debian
sudo apt-get install ffmpeg
```

### 3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç

```bash
# –ë–∞–∑–æ–≤–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞
python test_voice_changer.py

# –ü–æ–≤–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑ —Ç–µ—Å—Ç–æ–≤–∏–º —Ñ–∞–π–ª–æ–º
python test_voice_changer.py /path/to/test/video.mp4
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤

```
content-fabric/
‚îú‚îÄ‚îÄ core/utils/
‚îÇ   ‚îî‚îÄ‚îÄ voice_changer.py          # –û—Å–Ω–æ–≤–Ω–∏–π –º–æ–¥—É–ª—å
‚îú‚îÄ‚îÄ run_voice_changer.py           # CLI —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
‚îú‚îÄ‚îÄ test_voice_changer.py          # –¢–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îî‚îÄ‚îÄ task_worker.py             # –û–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è voice_change
‚îú‚îÄ‚îÄ docs/guides/
‚îÇ   ‚îî‚îÄ‚îÄ VOICE_CHANGER_GUIDE.md     # –ü–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ VOICE_CHANGER_QUICK_START.md   # –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç
‚îú‚îÄ‚îÄ TESTING_VOICE_CHANGER.md       # –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
‚îú‚îÄ‚îÄ VOICE_CHANGER_SUMMARY.md       # –¶–µ–π —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ requirements.txt               # –û–Ω–æ–≤–ª–µ–Ω–æ –∑ –Ω–æ–≤–∏–º–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—è–º–∏
```

## –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–æ–±–∫–∏

1. **–î–ª—è –≤—ñ–¥–µ–æ:**
   - –ï–∫—Å—Ç—Ä–∞–∫—Ü—ñ—è –∞—É–¥—ñ–æ –¥–æ—Ä—ñ–∂–∫–∏ (MoviePy)
   - –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è –≥–æ–ª–æ—Å—É (Praat)
   - –û–±'—î–¥–Ω–∞–Ω–Ω—è –∑ –≤—ñ–¥–µ–æ (MoviePy)
   - –ï–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É

2. **–î–ª—è –∞—É–¥—ñ–æ:**
   - –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞—É–¥—ñ–æ (Parselmouth)
   - –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è pitch (multiplication pitch tier)
   - –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è formants (formant grid scaling)
   - –ï–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É

### –ü–∞—Ä–∞–º–µ—Ç—Ä–∏

- **Pitch shift**: -12 –¥–æ +12 semitones
  - Positive = –≤–∏—â–∞ –≤–∏—Å–æ—Ç–∞ (–∂—ñ–Ω–æ—á–∏–π/–¥–∏—Ç—è—á–∏–π)
  - Negative = –Ω–∏–∂—á–∞ –≤–∏—Å–æ—Ç–∞ (—á–æ–ª–æ–≤—ñ—á–∏–π)

- **Formant shift**: 0.7 –¥–æ 1.4x
  - > 1.0 = –º–µ–Ω—à–∏–π vocal tract (–∂—ñ–Ω–æ—á–∏–π/–¥–∏—Ç—è—á–∏–π)
  - < 1.0 = –±—ñ–ª—å—à–∏–π vocal tract (—á–æ–ª–æ–≤—ñ—á–∏–π)

## –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å

–û—Ä—ñ—î–Ω—Ç–æ–≤–Ω–∏–π —á–∞—Å –æ–±—Ä–æ–±–∫–∏ –Ω–∞ M1 MacBook Pro:

| –¢–∏–ø —Ñ–∞–π–ª—É | –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å | –ß–∞—Å –æ–±—Ä–æ–±–∫–∏ | –Ø–∫—ñ—Å—Ç—å |
|-----------|------------|-------------|--------|
| Video 1080p | 1 —Ö–≤ | 30-45 —Å–µ–∫ | –í–∏—Å–æ–∫–∞ |
| Video 720p | 1 —Ö–≤ | 20-30 —Å–µ–∫ | –í–∏—Å–æ–∫–∞ |
| Audio WAV | 1 —Ö–≤ | 10-15 —Å–µ–∫ | –í–∏—Å–æ–∫–∞ |
| Audio MP3 | 1 —Ö–≤ | 15-20 —Å–µ–∫ | –í–∏—Å–æ–∫–∞ |

## –ì–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å –¥–æ production ‚úÖ

- ‚úÖ –ü–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞
- ‚úÖ –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ —Ç–∞ retry –º–µ—Ö–∞–Ω—ñ–∑–º
- ‚úÖ –õ–æ–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è —Ç–∞ –ø—Ä–∏–∫–ª–∞–¥–∏
- ‚úÖ –¢–µ—Å—Ç–æ–≤—ñ —Å–∫—Ä–∏–ø—Ç–∏
- ‚úÖ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —ñ—Å–Ω—É—é—á–æ—é —Å–∏—Å—Ç–µ–º–æ—é

## –ü–æ–¥–∞–ª—å—à—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

- üîÑ –î–æ–¥–∞—Ç–∏ –±—ñ–ª—å—à–µ –ø—Ä–µ—Å–µ—Ç—ñ–≤ (—Ä–æ–±–æ—Ç, echo, reverb)
- üîÑ Web API endpoint –¥–ª—è remote processing
- üîÑ Progress callbacks –¥–ª—è real-time updates
- üîÑ Noise reduction preprocessing
- üîÑ Automatic voice detection (male/female)
- üîÑ Preview mode (process first 10 seconds)

---

**–°—Ç–∞—Ç—É—Å: ‚úÖ –ì–û–¢–û–í–û –î–û –¢–ï–°–¢–£–í–ê–ù–ù–Ø**

–í–∏–∫–æ–Ω–∞–π—Ç–µ `python test_voice_changer.py` –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏!
