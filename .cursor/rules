# Content Fabric - AI Assistant Rules

## üìã Project Overview

Content Fabric - —ç—Ç–æ –º—É–ª—å—Ç–∏—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—É–¥–∏–æ –∏ –≤–∏–¥–µ–æ.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- üé¨ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ Instagram Reels, TikTok, YouTube Shorts
- üéôÔ∏è –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥–æ–ª–æ—Å–∞ (Voice Changer)
- üìã Task Management System –Ω–∞ –±–∞–∑–µ MySQL
- üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- ‚è∞ –°–∏—Å—Ç–µ–º–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—É–±–ª–∏–∫–∞—Ü–∏–π
- üîÑ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```
content-fabric/
‚îú‚îÄ‚îÄ app/                    # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ main.py            # –ì–ª–∞–≤–Ω—ã–π –≤—Ö–æ–¥–Ω–æ–π –º–æ–¥—É–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ auto_poster.py     # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –∞–≤—Ç–æ–ø–æ—Å—Ç–∏–Ω–≥–∞
‚îÇ   ‚îú‚îÄ‚îÄ scheduler.py       # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
‚îÇ   ‚îî‚îÄ‚îÄ task_worker.py     # –í–æ—Ä–∫–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á –∏–∑ –ë–î
‚îÇ
‚îú‚îÄ‚îÄ core/                  # –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ api_clients/       # API –∫–ª–∏–µ–Ω—Ç—ã –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base_client.py        # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å —Å rate limiting
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ youtube_client.py     # YouTube Data API v3
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ instagram_client.py   # Instagram Graph API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tiktok_client.py      # TikTok API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ youtube_db_client.py  # YouTube —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –ë–î
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ auth/              # –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ oauth_manager.py      # OAuth 2.0 flow
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ token_manager.py      # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ database/          # –°–ª–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sqlite_db.py          # SQLite –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mysql_db.py           # MySQL –¥–ª—è –∑–∞–¥–∞—á
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations/           # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ utils/             # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ voice_changer.py              # –ì–õ–ê–í–ù–´–ô: Voice Changer —Å–∏—Å—Ç–µ–º–∞
‚îÇ       ‚îú‚îÄ‚îÄ parallel_voice_processor.py   # –ù–û–í–û–ï: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îÇ       ‚îú‚îÄ‚îÄ audio_background_mixer.py     # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–∏
‚îÇ       ‚îú‚îÄ‚îÄ silero_voice_changer.py       # Silero TTS
‚îÇ       ‚îú‚îÄ‚îÄ rvc_inference.py              # RVC Voice Conversion
‚îÇ       ‚îú‚îÄ‚îÄ sovits_converter.py           # So-VITS-SVC
‚îÇ       ‚îú‚îÄ‚îÄ russian_stress.py             # –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —É–¥–∞—Ä–µ–Ω–∏–µ
‚îÇ       ‚îú‚îÄ‚îÄ content_processor.py          # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ
‚îÇ       ‚îú‚îÄ‚îÄ logger.py                     # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ       ‚îî‚îÄ‚îÄ notifications.py              # Telegram/Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ scripts/               # CLI —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ task_manager.py           # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ youtube_manager.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ YouTube
‚îÇ   ‚îú‚îÄ‚îÄ account_manager.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ setup_database.py         # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î
‚îÇ
‚îú‚îÄ‚îÄ config/                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ config.yaml               # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ mysql_config.yaml         # MySQL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ mysql_schema.sql          # SQL —Å—Ö–µ–º–∞
‚îÇ
‚îú‚îÄ‚îÄ data/                  # –î–∞–Ω–Ω—ã–µ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ content/                  # –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ databases/                # –õ–æ–∫–∞–ª—å–Ω—ã–µ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ logs/                     # –õ–æ–≥–∏
‚îÇ   ‚îî‚îÄ‚îÄ tokens/                   # –¢–æ–∫–µ–Ω—ã (legacy)
‚îÇ
‚îî‚îÄ‚îÄ docs/                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ guides/                   # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    ‚îú‚îÄ‚îÄ parallel/                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
    ‚îî‚îÄ‚îÄ technical/                # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### 2. –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### Voice Changer System üéôÔ∏è
**–§–∞–π–ª**: `core/utils/voice_changer.py`

–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥–æ–ª–æ—Å–∞:
- **–ú–µ—Ç–æ–¥—ã**: RVC, So-VITS-SVC, Silero TTS
- **–ü—Ä–µ—Å–µ—Ç—ã**: male_to_female, female_to_male, child_voice, –∏ –¥—Ä.
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 2-4 —Ä–∞–∑–∞ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –≤–æ–∫–∞–ª/–º—É–∑—ã–∫–∞

```python
class VoiceChanger:
    def __init__(
        self,
        enable_parallel: bool = True,      # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
        chunk_duration_minutes: int = 5,   # –†–∞–∑–º–µ—Ä —á–∞–Ω–∫–æ–≤
        max_workers: Optional[int] = None  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤
    )
    
    def process_file(
        self,
        input_file: str,
        output_file: str,
        method: str = 'silero',           # silero/rvc/sovits
        voice_model: str = 'kseniya',     # –ú–æ–¥–µ–ª—å –≥–æ–ª–æ—Å–∞
        preserve_background: bool = False, # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–æ–Ω
        use_parallel: bool = None         # –ê–≤—Ç–æ/–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ
    )
```

#### Parallel Voice Processor üöÄ
**–§–∞–π–ª**: `core/utils/parallel_voice_processor.py`

–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∞—É–¥–∏–æ –Ω–∞ —á–∞–Ω–∫–∏ (5 –º–∏–Ω—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ —Å crossfade
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–∏

```python
class ParallelVoiceProcessor:
    def split_audio(input_file) -> List[chunks]
    def process_chunks_parallel(chunks, processor_func)
    def reassemble_chunks(processed_chunks) -> audio
    def process_with_background(input_file, processor_func)
```

#### Task Management System üìã
**–§–∞–π–ª**: `core/database/mysql_db.py`

MySQL-based —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏:
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ –ë–î
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- CLI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```python
class Task:
    id: int
    account_name: str
    video_path: str
    title: str
    description: str
    keywords: str
    scheduled_time: datetime
    status: str  # pending/processing/completed/failed
```

#### API Clients üåê
**–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å**: `core/api_clients/base_client.py`

–í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –æ—Ç `BaseAPIClient`:
- Rate limiting
- Retry logic —Å exponential backoff
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã**:
- `youtube_client.py` - YouTube Data API v3
- `instagram_client.py` - Instagram Graph API
- `tiktok_client.py` - TikTok Content Posting API

## üéØ –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### 1. –ö–æ–¥

#### Python Style
- –ò—Å–ø–æ–ª—å–∑—É–π **type hints** –≤–µ–∑–¥–µ
- Docstrings –≤ —Ñ–æ—Ä–º–∞—Ç–µ Google Style
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `core.utils.logger.get_logger(__name__)`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: try/except —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏

```python
from typing import Optional, Dict, List
from core.utils.logger import get_logger

logger = get_logger(__name__)

def process_video(
    input_file: str,
    output_file: str,
    quality: str = 'high'
) -> Dict[str, any]:
    """
    Process video with specified quality.
    
    Args:
        input_file: Path to input video
        output_file: Path to output video
        quality: Quality preset ('high', 'medium', 'low')
        
    Returns:
        Dict with processing results
        
    Raises:
        ValueError: If quality preset is invalid
        FileNotFoundError: If input file doesn't exist
    """
    try:
        logger.info(f"Processing video: {input_file}")
        # ...
        return {"success": True, "file": output_file}
    except Exception as e:
        logger.error(f"Failed to process: {e}")
        raise
```

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Å–æ–≤
- –û–¥–∏–Ω –∫–ª–∞—Å—Å –Ω–∞ —Ñ–∞–π–ª (–µ—Å–ª–∏ –∫–ª–∞—Å—Å –±–æ–ª—å—à–æ–π)
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `_`
- –ò—Å–ø–æ–ª—å–∑—É–π `@property` –¥–ª—è –≥–µ—Ç—Ç–µ—Ä–æ–≤
- Cleanup –º–µ—Ç–æ–¥—ã –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

### 2. Voice Changer

#### –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –≥–æ–ª–æ—Å–æ–º:
1. **–í–°–ï–ì–î–ê** –∏—Å–ø–æ–ª—å–∑—É–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–ª—è —Ñ–∞–π–ª–æ–≤ > 3 –º–∏–Ω—É—Ç
2. **–í–°–ï–ì–î–ê** –ø—Ä–µ–¥–ª–∞–≥–∞–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –º—É–∑—ã–∫–∏
3. **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** cleanup –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
4. –ò—Å–ø–æ–ª—å–∑—É–π –∞–≤—Ç–æ-—Ä–µ–∂–∏–º (`use_parallel=None`) –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞

#### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```python
# –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
changer = VoiceChanger()
result = changer.process_file(
    'input.mp3', 'output.mp3',
    method='silero',
    voice_model='kseniya'
)
changer.cleanup()

# –° —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–æ–π
result = changer.process_file(
    'input.mp3', 'output.mp3',
    method='silero',
    preserve_background=True,
    vocals_gain=2.0,
    background_gain=-3.0
)

# –ö–∞—Å—Ç–æ–º–Ω–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
changer = VoiceChanger(
    enable_parallel=True,
    chunk_duration_minutes=3,
    max_workers=8
)
```

### 3. Task Management

#### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á:
1. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ —Ñ–∞–π–ª–∞
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ –ë–î
4. Scheduled time –≤ –±—É–¥—É—â–µ–º

```python
from core.database.mysql_db import YouTubeMySQLDatabase

db = YouTubeMySQLDatabase()
task_id = db.create_task(
    account_name='Channel Name',
    video_path='/path/to/video.mp4',
    title='Video Title',
    description='Description',
    keywords='tag1,tag2,tag3',
    scheduled_time=datetime(2025, 1, 1, 18, 0, 0)
)
```

### 4. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### SQLite vs MySQL:
- **SQLite** (`sqlite_db.py`): –ö–∞–Ω–∞–ª—ã YouTube, legacy —Ç–æ–∫–µ–Ω—ã
- **MySQL** (`mysql_db.py`): –ó–∞–¥–∞—á–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, –Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

#### –ú–∏–≥—Ä–∞—Ü–∏–∏:
- –°–æ–∑–¥–∞–≤–∞–π –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ `core/database/migrations/`
- –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ: `{verb}_{what}_migration.py`
- –ü—Ä–æ–≤–µ—Ä—è–π –Ω–∞–ª–∏—á–∏–µ —Ç–∞–±–ª–∏—Ü –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

### 5. API Clients

#### Rate Limiting:
- **Instagram**: ~200 calls/hour
- **TikTok**: varies by endpoint
- **YouTube**: 10,000 quota units/day

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
```python
from core.api_clients.youtube_client import YouTubeClient

client = YouTubeClient(channel_name='MyChannel')
try:
    result = client.upload_video(
        video_path='video.mp4',
        title='Title',
        description='Description'
    )
except QuotaExceededError:
    logger.error("YouTube quota exceeded")
    # Schedule for later
except RateLimitError as e:
    logger.warning(f"Rate limited, retry after {e.retry_after}s")
    # Wait and retry
```

### 6. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫:
1. Environment variables (`.env`)
2. `config/config.yaml`
3. `config/mysql_config.yaml` (–¥–ª—è –ë–î)
4. Default values –≤ –∫–æ–¥–µ

#### –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞:
```python
from core.utils.config_loader import load_config, get_platform_config

config = load_config()
youtube_config = get_platform_config('youtube')
```

### 7. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –£—Ä–æ–≤–Ω–∏:
- `DEBUG`: –î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `INFO`: –û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–Ω–∞—á–∞–ª–æ/–∫–æ–Ω–µ—Ü –æ–ø–µ—Ä–∞—Ü–∏–π)
- `WARNING`: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ)
- `ERROR`: –û—à–∏–±–∫–∏ (—Ç—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è)
- `CRITICAL`: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ (–∫—Ä–∞—Ö —Å–∏—Å—Ç–µ–º—ã)

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```python
logger.debug(f"Processing chunk {i}/{total}")
logger.info(f"Video uploaded successfully: {video_id}")
logger.warning(f"Low quota remaining: {quota}")
logger.error(f"Failed to upload: {error}")
logger.critical(f"Database connection lost!")
```

## üîÑ –†–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (Workflows)

### 1. Voice Changing Pipeline

```
Input Audio/Video
    ‚Üì
[Check duration]
    ‚Üì
< 3min? ‚Üí Sequential processing
> 3min? ‚Üí Parallel processing
    ‚Üì
[Has background music?]
    ‚Üì
Yes ‚Üí Separate vocals/instrumental
    ‚Üì
[Process voice]
    ‚Üì
[Reassemble chunks] (if parallel)
    ‚Üì
[Mix with background] (if separated)
    ‚Üì
Output Audio/Video
```

### 2. Task Publishing Pipeline

```
Task created in MySQL
    ‚Üì
Task Worker checks schedule
    ‚Üì
Time matches? ‚Üí Process task
    ‚Üì
Load video & metadata
    ‚Üì
Get channel tokens
    ‚Üì
Upload to platform
    ‚Üì
Update task status
    ‚Üì
Send notification
    ‚Üì
[Optional] Auto-comment & like
```

### 3. OAuth Flow

```
User requests auth
    ‚Üì
Generate auth URL
    ‚Üì
User authorizes in browser
    ‚Üì
Callback with code
    ‚Üì
Exchange for tokens
    ‚Üì
Store in database
    ‚Üì
Auto-refresh before expiry
```

## üìù –°–æ–≥–ª–∞—à–µ–Ω–∏—è

### –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ

#### –§–∞–π–ª—ã:
- Python: `snake_case.py`
- Config: `lowercase.yaml`
- Docs: `UPPERCASE.md`

#### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ/–§—É–Ω–∫—Ü–∏–∏:
- Variables: `snake_case`
- Functions: `snake_case`
- Classes: `PascalCase`
- Constants: `UPPER_SNAKE_CASE`

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
- Tables: `snake_case` (plural)
- Columns: `snake_case`
- –ò–Ω–¥–µ–∫—Å—ã: `idx_{table}_{column}`

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### –î–ª—è –Ω–æ–≤—ã—Ö —Ñ–∏—á:
1. –î–æ–±–∞–≤—å docstring –≤ –∫–æ–¥
2. –°–æ–∑–¥–∞–π/–æ–±–Ω–æ–≤–∏ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –≤ `docs/guides/`
3. –î–æ–±–∞–≤—å –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ `examples/`
4. –û–±–Ω–æ–≤–∏ `README.md` –µ—Å–ª–∏ —ç—Ç–æ major feature

#### –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:
1. –û–±–Ω–æ–≤–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
2. –î–æ–±–∞–≤—å –∑–∞–ø–∏—Å—å –≤ CHANGELOG (–µ—Å–ª–∏ –µ—Å—Ç—å)
3. –û–±–Ω–æ–≤–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ

### Git

#### Commit messages:
```
feat: Add parallel voice processing
fix: Fix token refresh race condition
docs: Update voice changer guide
refactor: Restructure API clients
perf: Optimize video processing pipeline
test: Add tests for parallel processor
```

#### Branches:
- `main` - production
- `develop` - development
- `feature/*` - –Ω–æ–≤—ã–µ —Ñ–∏—á–∏
- `fix/*` - –±–∞–≥—Ñ–∏–∫—Å—ã
- `docs/*` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### Security
- **–ù–ò–ö–û–ì–î–ê** –Ω–µ –∫–æ–º–º–∏—Ç—å —Ç–æ–∫–µ–Ω—ã, API keys, credentials
- –ò—Å–ø–æ–ª—å–∑—É–π `.env` –¥–ª—è sensitive –¥–∞–Ω–Ω—ã—Ö
- –•—Ä–∞–Ω–∏ —Ç–æ–∫–µ–Ω—ã –≤ –ë–î —Å encryption (TODO)
- –†–µ–≥—É–ª—è—Ä–Ω–æ rotate —Ç–æ–∫–µ–Ω—ã

### Performance
- Voice changing: –∏—Å–ø–æ–ª—å–∑—É–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
- API calls: batch –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- Database: –∏—Å–ø–æ–ª—å–∑—É–π –∏–Ω–¥–µ–∫—Å—ã
- File I/O: cleanup –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Error Handling
- –õ–æ–≥–∏—Ä—É–π –í–°–ï –æ—à–∏–±–∫–∏
- –ù–µ –≥–ª–æ—Ç–∞–π exceptions –º–æ–ª—á–∞
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π fallback –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- –£–≤–µ–¥–æ–º–ª—è–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö

### Testing
- –¢–µ—Å—Ç–∏—Ä—É–π –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
- –ü—Ä–æ–≤–µ—Ä—è–π edge cases (–ø—É—Å—Ç—ã–µ —Ñ–∞–π–ª—ã, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã)
- –ü—Ä–æ—Ñ–∏–ª–∏—Ä—É–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ü—Ä–æ–≤–µ—Ä—è–π memory leaks –ø—Ä–∏ –¥–æ–ª–≥–æ–π —Ä–∞–±–æ—Ç–µ

## üéì –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### 1. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —á–∞—Å—Ç–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ ThreadPool
- –°–±–æ—Ä–∫–∞ —Å crossfade
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –ø–æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –≤–æ–∫–∞–ª/–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—ã (audio-separator)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ –≤–æ–∫–∞–ª–∞
- –°–º–µ—à–∏–≤–∞–Ω–∏–µ —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º —Ñ–æ–Ω–æ–º
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Ä–æ–≤–Ω–µ–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏

### 3. OAuth & Token Management
- Authorization code flow
- Automatic token refresh
- Multi-account support
- Database storage

### 4. Task Scheduling
- Cron-like scheduling
- Database-driven tasks
- Automatic retry logic
- Status tracking

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞:
- **Voice Changer**: `docs/VOICE_CHANGER.md`
- **Parallel Processing**: `docs/parallel/PARALLEL_VOICE_PROCESSING.md`
- **Task Management**: `docs/guides/TASK_MANAGEMENT.md`
- **YouTube Setup**: `docs/guides/YOUTUBE_SETUP.md`
- **Russian Stress**: `docs/guides/RUSSIAN_STRESS_GUIDE.md`

### –ò–Ω–¥–µ–∫—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
–°–º. `DOCS_INDEX.md` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞

### –ü—Ä–∏–º–µ—Ä—ã:
- `examples/voice_changer_example.py`
- `examples/russian_stress_example.py`
- `test_parallel_voice_processing.py`

## ‚ö° –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# Voice Changer
python3 run_voice_changer.py input.mp4 output.mp4 --type male_to_female
python3 run_parallel_voice.py  # –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç

# Task Management
python3 run_task_manager.py create --account "Channel" --video video.mp4
python3 run_task_manager.py list
python3 run_task_worker.py  # –ó–∞–ø—É—Å–∫ –≤–æ—Ä–∫–µ—Ä–∞

# YouTube Management
python3 run_youtube_manager.py list
python3 run_youtube_manager.py upload

# Database
python3 run_setup_database.py
python3 run_migration_upload_id.py
```

## üéØ –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏

1. **–ü–æ–π–º–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç**: –ö–∞–∫–∞—è —á–∞—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –∑–∞—Ç—Ä–æ–Ω—É—Ç–∞?
2. **–ü—Ä–æ–≤–µ—Ä—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**: –ï—Å—Ç—å –ª–∏ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ?
3. **–°–ª–µ–¥—É–π –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º**: –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –ø–æ—Ö–æ–∂–∏–π –∫–æ–¥
4. **–õ–æ–≥–∏—Ä—É–π –≤—Å–µ**: –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏
5. **–¢–µ—Å—Ç–∏—Ä—É–π**: –ü—Ä–æ–≤–µ—Ä—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
6. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π**: –û–±–Ω–æ–≤–∏ docs –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

---

**–í–µ—Ä—Å–∏—è**: 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-10-13  
**–°—Ç–∞—Ç—É—Å**: Active

